https://bugzilla.mozilla.org/show_bug.cgi?id=1514633

CSC302 GFB Assignment Yau Yuen Wing

Overview & Diagnosis
The bug is in the nss security file.
The return value from the function sftk_GetPrivKey(obj, t, &crv) is conditionally freed if (k != obj->objectInfo) in a few cases.
This looks like a bad abstraction leak, but the truth is that sftk_GetPrivKey is only loaning the return value.

Solution
I changed the function sftk_GetPrivKey so that the private key is an outer parameter, instead of returning the key. The return value is changed to crv instead.
I also did some fixed on the uses of the function such that the declarations of variables are correct after I changed the return value of this function.


Testing
It is hard to test if my solution has successfully fixed all the memory leak and more guidance would be appreciated.
